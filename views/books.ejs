<%- include('layout/header') %>


<div class="container mt-5">
  <!-- The Nav Header -->
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link active fs-5" data-bs-toggle="tab" href="#allBooks">All Books</a>
    </li>

    <!-- A loop for each genre Header -->
    <% for( let i = 0; i < genres.length; i++ ) { %>
      <li class="nav-item">
        <a class="nav-link fs-5" data-bs-toggle="tab" href="#genre<%= genres[i].genreId %>"><%= genres[i].genreName %></a>
      </li>
    <% } %>
  </ul>


  <!-- The nave Body -->
  <div id="myTabContent" class="tab-content">
    <!-- The part of the all books -->
    <div class="tab-pane fade active show " id="allBooks">
      <div class="container mt-3">
        <h3 class="my-3">Books Count: <%= booksCount %> </h3>
        <table class="table ">
        <!-- <table class="table table-striped table-hover table-primary"> -->
          <thead>
            <tr>
              <th scope="col">name</th>
              <th scope="col">author</th>
              <th scope="col">pages</th>
              <th scope="col">genre</th>
              <th scope="col">book copy</th>
              <th scope="col">loaned</th>
              <th scope="col">did read</th>
            </tr>
          </thead>
          <tbody>
            <% for( let i = 0; i < books.length; i++ ) { %>
              <tr>
                <td><%= books[i].bookName %> </td>
                <td><%= books[i].authorName %> </td>
                <% if (books[i].bookPages) { %>
                  <td><%= books[i].bookPages %></td>
                <% } else { %>
                  <td>unknown</td>
                <% } %>
                <td><%= books[i].genreName %> </td>
                <td><%= books[i].bookCopy %> </td>
                <% if (books[i].readerId == 0) { %>
                  <td>NO</td>
                <% } else { %>
                  <td><%= books[i].readerName %> </td>
                <% } %>
  
                <% if (books[i].didRead == 1) { %>
                  <td>YES</td>
                <% } else { %>
                  <td>NO</td>
                <% } %>
                
              </tr>
            <% } %>
  
          </tbody>
        </table>
      </div>
    </div>

    <!-- A loop for each genre -->
    <% for( let i = 0; i < genres.length; i++ ) { %>
      <div class="tab-pane fade" id="genre<%= genres[i].genreId %>">
        <!-- The table of the genre -->
        <div class="container mt-3">
          <h3 class="my-3">Books Count: <%= genres[i]['COUNT(books.genreId)'] %> </h3>
          <table class="table">
            <thead>
              <tr>
                <th scope="col">name</th>
                <th scope="col">author</th>
                <th scope="col">pages</th>
                <th scope="col">book copy</th>
                <th scope="col">loaned</th>
                <th scope="col">did read</th>
              </tr>
            </thead>
            <tbody>
              <% for( let j = 0; j < books.length; j++ ) { %>
                <% if (books[j].genreId == genres[i].genreId) { %>
                  <tr>
                    <td><%= books[j].bookName %> </td>
                    <td><%= books[j].authorName %> </td>
                    <% if (books[j].bookPages) { %>
                      <td><%= books[j].bookPages %></td>
                    <% } else { %>
                      <td>unknown</td>
                    <% } %>
                    <td><%= books[j].bookCopy %> </td>
                    <% if (books[j].readerId == 0) { %>
                      <td>NO</td>
                    <% } else { %>
                      <td><%= books[j].readerName %> </td>
                    <% } %>
      
                    <% if (books[j].didRead == 1) { %>
                      <td>YES</td>
                    <% } else { %>
                      <td>NO</td>
                    <% } %>
                  </tr>
                <% } %>
                
              <% } %>
    
            </tbody>
          </table>
        </div>
      </div>     
    <% } %>

  </div>

<%- include('layout/footer') %>